{
  "version": 3,
  "file": "",
  "sourceRoot": "",
  "sources": [
    "../src/main.coffee"
  ],
  "names": [],
  "mappings": "AACA;EAAA;AAAA,MAAA,GAAA,EAAA,CAAA,EAAA,GAAA,EAAA,CAAA,EAAA,MAAA,EAAA,IAAA,EAAA,aAAA,EAAA,KAAA,EAAA,KAAA,EAAA,KAAA,EAAA,IAAA,EAAA,KAAA,EAAA,IAAA,EAAA,IAAA,EAAA,UAAA,EAAA,SAAA,EAAA,OAAA,EAAA,GAAA,EAAA,QAAA,EAAA,QAAA,EAAA,MAAA,EAAA,GAAA,EAAA,GAAA,EAAA,KAAA,EAAA,IAAA,EAAA,IAAA,EAAA,OAAA,EAAA,CAAA;IAAA;sBAAA;;;;EAKA,QAAA,GAA4B,OAAA,CAAQ,MAAR,EAL5B;;;;EAQA,GAAA,GAA4B,OAAA,CAAQ,KAAR;;EAC5B,GAAA,GAA4B,GAAG,CAAC,GAAG,CAAC,IAAR,CAAa,GAAb;;EAC5B,KAAA,GAA4B;;EAC5B,GAAA,GAA4B,GAAG,CAAC,UAAJ,CAAe,OAAf,EAA4B,KAA5B;;EAC5B,IAAA,GAA4B,GAAG,CAAC,UAAJ,CAAe,MAAf,EAA4B,KAA5B;;EAC5B,OAAA,GAA4B,GAAG,CAAC,UAAJ,CAAe,SAAf,EAA4B,KAA5B;;EAC5B,KAAA,GAA4B,GAAG,CAAC,UAAJ,CAAe,OAAf,EAA4B,KAA5B;;EAC5B,KAAA,GAA4B,GAAG,CAAC,UAAJ,CAAe,OAAf,EAA4B,KAA5B;;EAC5B,IAAA,GAA4B,GAAG,CAAC,UAAJ,CAAe,MAAf,EAA4B,KAA5B;;EAC5B,IAAA,GAA4B,GAAG,CAAC,UAAJ,CAAe,MAAf,EAA4B,KAA5B;;EAC5B,IAAA,GAA4B,GAAG,CAAC,UAAJ,CAAe,MAAf,EAA4B,KAA5B;;EAC5B,MAAA,GAA4B,GAAG,CAAC,UAAJ,CAAe,QAAf,EAA4B,KAA5B;;EAC5B,IAAA,GAA4B,GAAG,CAAC,IAAI,CAAC,IAAT,CAAc,GAAd,EApB5B;;;EAsBA,GAAA,GAA4B,OAAA,CAAQ,KAAR;;EAC5B,CAAA,GAA4B,OAAA,CAAQ,UAAR;;EAC5B,CAAA,GAA4B,OAAA,CAAQ,WAAR;;EAC5B,MAAA,GAA4B,OAAA,CAAQ,UAAR;;EAC5B,IAAA,GAA4B;;EAC5B,KAAA,GAA4B,IAAI,CAAE,OAAA,CAAQ,WAAR,CAAF,CAAuB,CAAC,SAA5B,CAAA;;EAC5B,IAAC,CAAA,QAAD,GAA4B,CAAA,EA5B5B;;;EA+BA,KAAK,CAAC,OAAN,CAAc,0BAAd,EAA0C;IAAA,KAAA,EACxC;MAAA,eAAA,EAAsC,QAAA,CAAE,CAAF,CAAA;eAAS,IAAC,CAAA,GAAG,CAAC,MAAL,CAAY,CAAZ;MAAT,CAAtC;MACA,oCAAA,EAAsC,QAAA,CAAE,CAAF,CAAA;eAAS,IAAC,CAAA,YAAY,CAAC,aAAd,CAA4B,CAAC,CAAC,IAA9B;MAAT,CADtC;MAEA,sBAAA,EAAsC,QAAA,CAAE,CAAF,CAAA;eAAS,IAAC,CAAA,GAAG,CAAC,QAAL,CAAc,CAAC,CAAC,IAAhB;MAAT,CAFtC;MAGA,kEAAA,EAAoE,QAAA,CAAE,CAAF,CAAA;QAClE,IAAe,IAAC,CAAA,GAAG,CAAC,aAAL,CAAmB,CAAC,CAAC,MAArB,CAAf;AAAA,iBAAO,KAAP;;QACA,KAAoB,IAAC,CAAA,GAAG,CAAC,IAAL,CAAU,CAAC,CAAC,MAAZ,CAApB;AAAA,iBAAO,MAAP;;AACA,eAAO,CAAC,CAAC,MAAM,CAAC,KAAT,CAAe,CAAE,CAAF,CAAA,GAAA;iBAAS,CAAE,IAAC,CAAA,GAAG,CAAC,aAAL,CAAmB,CAAnB,CAAF,CAAA,IAA6B,CAAM,OAAS,CAAC,IAAZ,CAAiB,CAAjB;QAA1C,CAAf;MAH2D;IAHpE;EADwC,CAA1C,EA/BA;;;EAwCA,IAAC,CAAA,QAAQ,CAAC,wBAAV,GACE;IAAA,MAAA,EAAkB,OAAlB;IACA,IAAA,EAAkB,IADlB;IAEA,IAAA,EAAkB;EAFlB,EAzCF;;;EA8CA,KAAK,CAAC,OAAN,CAAc,2BAAd,EAA2C;IAAA,KAAA,EACzC;MAAA,eAAA,EAAsC,QAAA,CAAE,CAAF,CAAA;eAAS,IAAC,CAAA,GAAG,CAAC,MAAL,CAAY,CAAZ;MAAT,CAAtC;MACA,mCAAA,EAAsC,QAAA,CAAE,CAAF,CAAA;eAAS,IAAC,CAAA,YAAY,CAAC,aAAd,CAA4B,CAAC,CAAC,GAA9B;MAAT;IADtC;EADyC,CAA3C,EA9CA;;;EAkDA,IAAC,CAAA,QAAQ,CAAC,yBAAV,GACE;IAAA,GAAA,EAAkB;EAAlB,EAnDF;;;EAsDM,gBAAN,MAAA,cAAA,QAA4B,GAAG,CAAC,KAAK,CAAC,aAAtC,CAAA,EAtDA;;;EA0DM,IAAC,CAAA,WAAP,MAAA,SAAA,QAAwB,cAAxB,CAAA;;IAGE,WAAa,CAAE,GAAF,EAAO,GAAP,CAAA;AACf,UAAA,CAAA,EAAA,CAAA;;WACI,CAAA;MACA,GAAG,CAAC,KAAK,CAAC,IAAV,CAAe,IAAf,EAAkB,KAAlB,EAAyB,GAAzB;MACA,GAAA,GAAc,CAAE,GAAA,IAAI,CAAC,QAAQ,CAAC,wBAAhB,EAA6C,GAAA,GAA7C;MACd,GAAG,CAAC,MAAJ,GAAc,IAAC,CAAA,eAAD,CAAiB,GAAG,CAAC,MAArB;MACd,KAAK,CAAC,QAAQ,CAAC,wBAAf,CAAwC,GAAxC;MACA,GAAG,CAAC,IAAJ,GAAc,GAAG,CAAC,IAAI,CAAC,IAAT,CAAc,GAAd;MACd,IAA0B,GAAG,CAAC,cAAJ,IAA2B,kBAArD;QAAA,GAAG,CAAC,IAAJ,GAAc,SAAd;;;QACA,GAAG,CAAC,OAAU;;MACd,KAAA,QAAA;;QAAA,IAAC,CAAE,CAAF,CAAD,GAAc;MAAd;AACA,aAAO,GAAG,CAAC,GAAG,CAAC,MAAR,CAAe,IAAf;IAXI,CADf;;;IAeE,eAAiB,CAAE,MAAF,CAAA;AACnB,UAAA,CAAA,EAAA,KAAA,EAAA,CAAA,EAAA;MAAI,CAAA,GAAO,CAAE,KAAK,CAAC,GAAG,CAAC,IAAV,CAAe,MAAf,CAAF,CAAH,GAAkC,MAAM,CAAC,KAAP,CAAa,SAAb,CAAlC,GAA8D;MAClE,KAAA,mCAAA;;QACE,IAAY,IAAC,CAAA,GAAG,CAAC,OAAO,CAAC,UAAU,CAAC,GAAxB,CAA4B,KAA5B,CAAZ;AAAA,mBAAA;;QACA,MAAM,IAAI,CAAC,CAAC,kBAAN,CAAyB,sBAAzB,EAAiD,CAAA,oBAAA,CAAA,CAAuB,GAAA,CAAI,KAAJ,CAAvB,CAAA,CAAjD;MAFR;AAGA,aAAO;IALQ;;EAjBnB,EA1DA;;;QAoFM,IAAC,CAAA;IAAP,MAAA,UAAA,QAAyB,cAAzB,CAAA;;MAIE,WAAa,CAAE,GAAF,CAAA;AACf,YAAA,KAAA,EAAA;;;YAeE,CAAA,cAAA,CAAA;;YAsBA,CAAA,yBAAA,CAAA;;YAKA,CAAA,WAAA,CAAA;;YAYA,CAAA,kBAAA,CAAA;;YAyBA,CAAA,iBAAA,CAAA;QA9EE,IAAC,CAAA,GAAD,GAAY,CAAE,GAAA,IAAI,CAAC,QAAQ,CAAC,yBAAhB,EAA8C,GAAA,GAA9C;QACZ,GAAG,CAAC,KAAK,CAAC,IAAV,CAAe,IAAf,EAAkB,SAAlB,EAA6B,IAAI,MAAM,CAAC,0BAAX,CAAA,CAA7B;QACA,IAAC,CAAA,GAAD,GAAY,IAAI,GAAG,CAAC,KAAK,CAAC,YAAd,CAAA;QACZ,IAAC,CAAA,MAAD,GAAY,CAAA;AAEZ;;QAAA,KAAA,aAAA;UACE,IAAC,CAAA,MAAM,CAAE,KAAF,CAAP,GAAmB,IAAI,GAAJ,CAAA;UAChB,CAAA,CAAE,KAAF,CAAA,GAAA;mBACD,GAAG,CAAC,KAAK,CAAC,IAAV,CAAe,IAAC,CAAA,GAAhB,EAAqB,KAArB,EAA4B,CAAE,CAAF,CAAA,GAAA;qBAAS,IAAC,CAAA,MAAM,CAAE,KAAF,CAAS,CAAC,GAAjB,CAAqB,IAAC,CAAA,OAAD,CAAS,CAAT,CAArB;YAAT,CAA5B;UADC,CAAA,EAAE;QAFP;QAIA,GAAG,CAAC,GAAG,CAAC,MAAR,CAAe,IAAC,CAAA,MAAhB,EAVJ;;AAYI,eAAO;MAbI;;MAgBb,OAAS,CAAE,IAAF,EAAQ,QAAR,CAAA;AACX,YAAA,KAAA,EAAA,KAAA,EAAA,SAAA,EAAA,CAAA,EAAA,CAAA,EAAA,GAAA,EAAA,IAAA,EAAA,IAAA,EAAA,IAAA,EAAA;;QAAI,QAAA,GAAgB,IAAI,IAAI,CAAC,QAAT,CAAkB,IAAlB,EAAqB,QAArB;QAChB,GAAG,CAAC,KAAK,CAAC,IAAV,CAAe,IAAC,CAAA,GAAhB,EAAqB,IAArB,EAA2B,QAAQ,CAAC,IAApC;AACA;QAAA,KAAA,sCAAA;0BAAA;;;UAGE,IAAC,CAAA,kBAAD,CAAoB,KAApB,EAA2B,IAA3B;AAEA;;UAAA,KAAA,iBAAA;YACE,IAAY,SAAS,CAAC,MAAV,KAAoB,CAAhC;AAAA,uBAAA;;YACA,IAAA,GAAO,IAAC,CAAA;YACR,KAAA,6CAAA;;cACE,KAAO,IAAI,CAAC,GAAL,CAAS,KAAT,CAAP;gBACE,GAAG,CAAC,KAAK,CAAC,IAAV,CAAe,IAAf,EAAqB,KAArB,EAA4B,IAAI,GAAG,CAAC,KAAK,CAAC,YAAd,CAAA,CAA5B,EADF;eAAV;;cAGU,IAAA,GAAO,IAAI,CAAE,KAAF;YAJb,CAFR;;YAQW,CAAA,CAAE,SAAF,CAAA,GAAA;qBACD,GAAG,CAAC,KAAK,CAAC,IAAV,CAAe,IAAf,EAAqB,IAArB,EAA2B,CAAE,CAAF,CAAA,GAAA;uBAAS,IAAC,CAAA,IAAD,CAAM,GAAA,SAAN,EAAoB,IAApB,EAA0B,CAA1B;cAAT,CAA3B;YADC,CAAA,EAAE;UATP;QALF;AAgBA,eAAO;MAnBA;;MAsBT,kBAAoB,CAAE,KAAF,EAAS,IAAT,CAAA;;QAClB,IAAC,CAAA,MAAM,CAAE,KAAF,CAAS,CAAC,GAAjB,CAAqB,IAArB;AACA,eAAO;MAFW;;MAKpB,IAAM,CAAA,GAAE,MAAF,CAAA;AACR,YAAA,KAAA,EAAA,CAAA,EAAA,GAAA,EAAA,IAAA,EAAA,IAAA,EAAA,QAAA,EAAA,OAAA,EAAA;;4CADqB,MAAM;QACvB,KAAA,wCAAA;;UACE,KAAoB,IAAC,CAAA,WAAD,CAAa,KAAb,EAAoB,CAApB,CAApB;AAAA,mBAAO,MAAP;;QADF,CAAJ;;;QAII,IAAO,6CAAP;UACE,MAAM,IAAI,CAAC,CAAC,kBAAN,CAAyB,eAAzB,EAA0C,CAAA,aAAA,CAAA,CAAgB,GAAA,CAAI,IAAJ,CAAhB,CAAA,CAA1C,EADR;SAJJ;;QAOI,OAAA,GAAU,QAAA,CAAS,CAAT;AACV,eAAO,IAAC,CAAA,aAAD,CAAe,IAAf,EAAqB,OAArB,EAA8B,OAA9B;MATH;;MAYN,WAAa,CAAE,KAAF,EAAS,CAAT,CAAA;AACf,YAAA,CAAA,EAAA,CAAA,EAAA;;QAAI,IAAO,iEAAP;UACE,MAAM,IAAI,CAAC,CAAC,kBAAN,CAAyB,eAAzB,EAA0C,CAAA,cAAA,CAAA,CAAiB,GAAA,CAAI,KAAJ,CAAjB,CAAA,CAA1C,EADR;SAAJ;;AAGI,gBAAO,CAAA,GAAI,SAAA,CAAU,CAAV,CAAX;AAAA,eACO,CAAC,CAAC,OAAO,CAAC,cADjB;AACuC,mBAAO,IAAC,CAAA,aAAD,CAAe,KAAf,EAAsB,CAAtB,EAAyB,IAAzB;AAD9C,eAEO,CAAC,CAAC,OAAO,CAAC,eAFjB;AAEuC,mBAAO,IAAC,CAAA,aAAD,CAAe,KAAf,EAAsB,CAAtB,EAAyB,KAAzB;AAF9C,eAGO,KAHP;AAGuC,mBAAO,IAAC,CAAA,aAAD,CAAe,KAAf,EAAsB,CAAtB,EAAyB,KAAzB;AAH9C,eAIO,IAJP;AAIuC,mBAAO,IAAC,CAAA,aAAD,CAAe,KAAf,EAAsB,CAAtB,EAAyB,IAAzB,EAJ9C;;AAAA,eAMO,CAAC,CAAC,OAAO,CAAC,qBANjB;AAAA,eAMwC,CAAC,CAAC,OAAO,CAAC,oBANlD;YAOI,KAAA,MAAA;cACE,KAAO,IAAC,CAAA,IAAD,CAAM,GAAA,MAAN,EAAiB,IAAjB,EAAuB,CAAvB,CAAP;AACE,uBAAO,IAAC,CAAA,aAAD,CAAe,KAAf,EAAsB,CAAtB,EAAyB,KAAzB,EADT;;YADF;AAGA,mBAAO,IAAC,CAAA,aAAD,CAAe,KAAf,EAAsB,CAAtB,EAAyB,IAAzB;AAVX,SAHJ;;QAeI,MAAM,IAAI,CAAC,CAAC,wBAAN,CAA+B,eAA/B,EACJ,CAAA,mDAAA,CAAA,CAAsD,GAAA,CAAI,KAAJ,CAAtD,CAAA,EAAA,CAAA,CAAoE,GAAA,CAAI,CAAJ,CAApE,CAAA,CADI;MAhBK,CAxDf;;;MA4EE,aAAe,CAAE,IAAF,EAAQ,MAAR,EAAgB,OAAhB,CAAA,EAAA;;AAEb,eAAO;MAFM;;MAKf,UAA4B,CAAE,CAAF,CAAA;;eAAS,CAAE,CAAE,MAAM,CAAA,SAAE,CAAA,QAAQ,CAAC,IAAjB,CAAsB,CAAtB,CAAF,CAA2B,CAAC,KAA5B,CAAkC,CAAlC,EAAqC,CAAC,CAAtC,CAAF,CAA2C,CAAC,WAA5C,CAAA,CAAyD,CAAC,OAA1D,CAAkE,MAAlE,EAA0E,EAA1E;MAAT;;MAC5B,eAA4B,CAAE,IAAF,CAAA;eAAY,IAAI,CAAC,WAAL,CAAA,CAAkB,CAAC,OAAnB,CAA2B,MAA3B,EAAmC,EAAnC;MAAZ,CAlF9B;;;MAsFE,OAAS,CAAE,CAAF,CAAA;AACX,YAAA,CAAA,EAAA,KAAA,EAAA,CAAA,EAAA;QAAI,IAAkE,CAAE,KAAA,GAAQ,SAAS,CAAC,MAApB,CAAA,KAAgC,CAAlG;UAAA,MAAM,IAAI,KAAJ,CAAU,CAAA,gCAAA,CAAA,CAAmC,KAAnC,CAAA,CAAV,EAAN;;QACA,IAAuB,CAAA,KAAK,IAA5B;AAAA,iBAAO,OAAP;;QACA,IAAuB,CAAA,KAAK,MAA5B;AAAA,iBAAO,YAAP;;QACA,IAAuB,CAAE,CAAA,KAAK,KAAP,CAAA,IAAuB,CAAE,CAAA,KAAK,CAAC,KAAR,CAA9C;AAAA,iBAAO,WAAP;;QACA,IAAuB,CAAE,CAAA,KAAK,IAAP,CAAA,IAAuB,CAAE,CAAA,KAAK,KAAP,CAA9C;AAAA,iBAAO,UAAP;;QACA,IAAyB,MAAM,CAAC,KAAP,CAAiB,CAAjB,CAAzB;AAAA,iBAAO,MAAP;;QACA,IAAyB,MAAM,CAAC,QAAP,CAAiB,CAAjB,CAAzB;AAAA,iBAAO,QAAP;;QACA,IAAyB,MAAM,CAAC,QAAP,CAAiB,CAAjB,CAAzB;AAAA,iBAAO,SAAP;;QACA,IAAyB,KAAK,CAAC,OAAN,CAAe,CAAf,CAAzB;AAAA,iBAAO,OAAP;SARJ;;;;QAYI,IAAG,2CAAA,IAA2C,CAAE,OAAO,OAAT,CAAA,KAAsB,QAApE;AACE,iBAAO,IAAC,CAAA,eAAD,CAAiB,OAAjB,EADT;;QAIA,IAAuB,CAAE,CAAA,GAAI,CAAC,CAAC,WAAR,CAAA,KAAyB,MAAhD;;;AAAA,iBAAO,aAAP;;QACA,IAAuB,CAAE,OAAO,CAAT,CAAA,KAAkB,UAAzC;AAAA,iBAAO,SAAP;;QACA,IAAG,CAAE,CAAA,GAAI,CAAC,CAAC,IAAI,CAAC,WAAP,CAAA,CAAN,CAAA,KAAgC,EAAnC;UACE,IAAsB,CAAC,CAAC,WAAF,KAAiB,IAAC,CAAA,0BAAxC;AAAA,mBAAO,YAAP;WAAN;;AAEM,iBAAO,CAAE,CAAE,MAAM,CAAA,SAAE,CAAA,QAAQ,CAAC,IAAjB,CAAsB,CAAtB,CAAF,CAA2B,CAAC,KAA5B,CAAkC,CAAlC,EAAqC,CAAC,CAAtC,CAAF,CAA2C,CAAC,WAA5C,CAAA,EAHT;;QAKA,IAAqB,CAAE,OAAO,CAAP,KAAY,QAAd,CAAA,KAA6B,MAAO,aAAP,MAAkB,YAAlB,MAA4B,SAA9E;;AAFmE,wBAEnE,iBAAO,UAAP;;QACA,IAAqB,CAAA,KAAK,QAA1B;AAAA,iBAAO,QAAP;;QACA,IAAqB,CAAA,KAAK,QAA1B;AAAA,iBAAO,OAAP;;QAGA,IAAqB,CAAA,KAAK,UAAL,IAAoB,CAAC,CAAC,QAAF,CAAA,CAAY,CAAC,UAAb,CAAwB,QAAxB,CAAzC;;;AAAA,iBAAO,QAAP;;AACA,eAAO;MA9BA;;IAzFX;;wBAsFE,0BAAA,GAA4B,CAAE,CAAE,SAAA,CAAA,CAAA;aAAG,CAAA,MAAM,EAAN;IAAH,CAAF,CAAA,CAAA,CAAF,CAAqB,CAAC;;;;gBA1KpD;;;EA8MA,IAAC,CAAA,QAAD,GAAY,GAAG,CAAC,GAAG,CAAC,MAAR,CAAe,IAAC,CAAA,QAAhB,EA9MZ;;;EAiNA,CAAA,GAAI,IAAI,IAAC,CAAA,SAAL,CAAA,EAjNJ;;;;;;;;EAyNA,UAAA,GAA2B,CAAE,CAAF,CAAA,GAAA;WAAS,CAAE,CAAE,MAAM,CAAA,SAAE,CAAA,QAAQ,CAAC,IAAjB,CAAsB,CAAtB,CAAF,CAA2B,CAAC,KAA5B,CAAkC,CAAlC,EAAqC,CAAC,CAAtC,CAAF,CAA2C,CAAC,WAA5C,CAAA,CAAyD,CAAC,OAA1D,CAAkE,MAAlE,EAA0E,EAA1E;EAAT;;EAC3B,SAAA,GAAY,QAAA,CAAE,CAAF,CAAA;IACV,IAA6B,SAA7B;MAAA,MAAM,IAAI,KAAJ,CAAU,KAAV,EAAN;;IACA,IAAmB,MAAM,CAAC,cAAP,CAAsB,CAAtB,EAAyB,MAAzB,CAAnB;AAAA,aAAO,CAAC,CAAC,OAAT;;IACA,IAAmB,MAAM,CAAC,cAAP,CAAsB,CAAtB,EAAyB,IAAzB,CAAnB;AAAA,aAAO,CAAC,CAAC,KAAT;;IACA,IAAmC,CAAE,UAAA,CAAW,CAAX,CAAF,CAAA,KAAoB,QAAvD;AAAA,aAAO,CAAE,MAAM,CAAC,IAAP,CAAY,CAAZ,CAAF,CAAiB,CAAC,OAAzB;;IACA,MAAM,IAAI,KAAJ,CAAU,KAAV;EALI;;EAMZ,QAAA,GAAY,QAAA,CAAE,CAAF,CAAA;WAAS,CAAE,SAAA,CAAU,CAAV,CAAF,CAAA,GAAkB;EAA3B;;EACZ,KAAA,GAAY,QAAA,CAAE,CAAF,CAAA;WAAS,CAAE,SAAA,CAAU,CAAV,CAAF,CAAA,KAAmB;EAA5B;;EACZ,OAAA,GAAY,QAAA,CAAE,IAAF,EAAQ,CAAR,CAAA;IACV,IAAoB,CAAE,UAAA,CAAW,CAAX,CAAF,CAAA,KAAoB,OAAxC;AAAA,aAAO,MAAP;;IACA,IAAe,CAAC,CAAC,MAAF,KAAY,CAA3B;AAAA,aAAO,KAAP;KADF;;AAGE,WAAO,CAAC,CAAC,KAAF,CAAQ,QAAA,CAAE,CAAF,CAAA;aAAS,CAAE,UAAA,CAAW,CAAX,CAAF,CAAA,KAAoB,IAAK;IAAlC,CAAR;EAJG;;EAlOZ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA",
  "sourcesContent": [
    "\n'use strict'\n\n\n############################################################################################################\n# njs_util                  = require 'util'\nnjs_path                  = require 'path'\n# njs_fs                    = require 'fs'\n#...........................................................................................................\nCND                       = require 'cnd'\nrpr                       = CND.rpr.bind CND\nbadge                     = 'INTERTYPE/main'\nlog                       = CND.get_logger 'plain',     badge\ninfo                      = CND.get_logger 'info',      badge\nwhisper                   = CND.get_logger 'whisper',   badge\nalert                     = CND.get_logger 'alert',     badge\ndebug                     = CND.get_logger 'debug',     badge\nwarn                      = CND.get_logger 'warn',      badge\nhelp                      = CND.get_logger 'help',      badge\nurge                      = CND.get_logger 'urge',      badge\npraise                    = CND.get_logger 'praise',    badge\necho                      = CND.echo.bind CND\n#...........................................................................................................\nGUY                       = require 'guy'\nE                         = require './errors'\nH                         = require './helpers'\nHEDGES                    = require './hedges'\nITYP                      = @\ntypes                     = new ( require 'intertype' ).Intertype()\n@defaults                 = {}\n\n#-----------------------------------------------------------------------------------------------------------\ntypes.declare 'Type_cfg_constructor_cfg', tests:\n  \"@isa.object x\":                      ( x ) -> @isa.object x\n  \"@isa_optional.nonempty_text x.size\": ( x ) -> @isa_optional.nonempty_text x.size\n  \"@isa.function x.test\":               ( x ) -> @isa.function x.test\n  \"x.groups is a nonempty text or a nonempty list of nonempty texts\": ( x ) ->\n    return true if @isa.nonempty_text x.groups\n    return false unless @isa.list x.groups\n    return x.groups.every ( e ) => ( @isa.nonempty_text e ) and not ( /[\\s,]/ ).test e\n#...........................................................................................................\n@defaults.Type_cfg_constructor_cfg =\n  groups:           'other'\n  size:             null  # defaults to `'length'` where `isa_collection` is `true`\n  test:             null\n\n#-----------------------------------------------------------------------------------------------------------\ntypes.declare 'Intertype_constructor_cfg', tests:\n  \"@isa.object x\":                      ( x ) -> @isa.object x\n  \"@isa_optional.nonempty_text x.sep\":  ( x ) -> @isa_optional.nonempty_text x.sep\n#...........................................................................................................\n@defaults.Intertype_constructor_cfg =\n  sep:              '$'\n\n#===========================================================================================================\nclass Intertype_abc extends GUY.props.Strict_owner\n\n\n#===========================================================================================================\nclass @Type_cfg extends Intertype_abc\n\n  #---------------------------------------------------------------------------------------------------------\n  constructor: ( hub, cfg ) ->\n    ### TAINT ensure type_cfg does not contain `type`, `name` ###\n    super()\n    GUY.props.hide @, 'hub', hub\n    cfg         = { ITYP.defaults.Type_cfg_constructor_cfg..., cfg..., }\n    cfg.groups  = @_compile_groups cfg.groups\n    types.validate.Type_cfg_constructor_cfg cfg\n    cfg.test    = cfg.test.bind hub\n    cfg.size    = 'length' if cfg.isa_collection and not cfg.size?\n    cfg.size   ?= null\n    @[ k ]      = v for k, v of cfg\n    return GUY.lft.freeze @\n\n  #---------------------------------------------------------------------------------------------------------\n  _compile_groups: ( groups ) ->\n    R = if ( types.isa.text groups ) then groups.split /\\s*,\\s*/ else groups\n    for group in R\n      continue if @hub._hedges.hedgepaths.has group\n      throw new E.Intertype_ETEMPTBD '^intertype/Type_cfg^', \"unknown hedge group #{rpr group}\"\n    return R\n\n\n#===========================================================================================================\nclass @Intertype extends Intertype_abc\n\n\n  #---------------------------------------------------------------------------------------------------------\n  constructor: ( cfg ) ->\n    super()\n    @cfg      = { ITYP.defaults.Intertype_constructor_cfg..., cfg..., }\n    GUY.props.hide @, '_hedges', new HEDGES.Intertype_hedge_combinator()\n    @isa      = new GUY.props.Strict_owner()\n    @groups   = {}\n    #.......................................................................................................\n    for group from @_hedges._get_groupnames()\n      @groups[ group ] = new Set()\n      do ( group ) =>\n        GUY.props.hide @isa, group, ( x ) => @groups[ group ].has @type_of x\n    GUY.lft.freeze @groups\n    #.......................................................................................................\n    return undefined\n\n  #---------------------------------------------------------------------------------------------------------\n  declare: ( type, type_cfg ) =>\n    type_cfg      = new ITYP.Type_cfg @, type_cfg\n    GUY.props.hide @isa, type, type_cfg.test\n    for group in type_cfg.groups\n      #.....................................................................................................\n      ### register type with group ###\n      @_add_type_to_group group, type\n      #.....................................................................................................\n      for hedgepath from @_hedges.hedgepaths[ group ]\n        continue if hedgepath.length is 0\n        self = @isa\n        for hedge in hedgepath\n          unless self.has hedge\n            GUY.props.hide self, hedge, new GUY.props.Strict_owner()\n            # self[ hedge ] = new GUY.props.Strict_owner()\n          self = self[ hedge ]\n        #...................................................................................................\n        do ( hedgepath ) =>\n          GUY.props.hide self, type, ( x ) => @_isa hedgepath..., type, x\n    return null\n\n  #---------------------------------------------------------------------------------------------------------\n  _add_type_to_group: ( group, type ) =>\n    @groups[ group ].add type\n    return null\n\n  #---------------------------------------------------------------------------------------------------------\n  _isa: ( hedges..., type, x ) =>\n    for hedge in hedges\n      return false unless @_test_hedge hedge, x\n    # urge '^345^', { hedge, hedges, type, x, }\n    #.......................................................................................................\n    unless ( typetest = @isa.get type, null )?\n      throw new E.Intertype_ETEMPTBD '^intertype@1^', \"unknown type #{rpr type}\"\n    # debug '^3435^', { hedges, type, x, }\n    verdict = typetest x\n    return @_protocol_isa type, verdict, verdict\n\n  #---------------------------------------------------------------------------------------------------------\n  _test_hedge: ( hedge, x ) =>\n    unless ( hedgetest = @_hedges._hedgemethods.get hedge, null )?\n      throw new E.Intertype_ETEMPTBD '^intertype@1^', \"unknown hedge #{rpr hedge}\"\n    #.......................................................................................................\n    switch R = hedgetest x\n      when H.signals.true_and_break   then return @_protocol_isa hedge, R, true\n      when H.signals.false_and_break  then return @_protocol_isa hedge, R, false\n      when false                      then return @_protocol_isa hedge, R, false\n      when true                       then return @_protocol_isa hedge, R, true\n      #.....................................................................................................\n      when H.signals.process_list_elements, H.signals.process_set_elements\n        for e from x\n          unless @_isa hedges..., type, e\n            return @_protocol_isa hedge, R, false\n        return @_protocol_isa hedge, R, true\n    #.......................................................................................................\n    throw new E.Intertype_internal_error '^intertype@1^', \\\n      \"unexpected return value from hedgemethod for hedge #{rpr hedge}: #{rpr R}\"\n\n  #---------------------------------------------------------------------------------------------------------\n  _protocol_isa: ( term, result, verdict ) ->\n    # urge '^_protocol_isa@1^', { term, result, verdict, }\n    return verdict\n\n  #---------------------------------------------------------------------------------------------------------\n  js_type_of:                 ( x ) => ( ( Object::toString.call x ).slice 8, -1 ).toLowerCase().replace /\\s+/g, ''\n  _normalize_type:            ( type ) -> type.toLowerCase().replace /\\s+/g, ''\n  _constructor_of_generators: ( ( -> yield 42 )() ).constructor\n\n  #---------------------------------------------------------------------------------------------------------\n  type_of: ( x ) ->\n    throw new Error \"^7746^ expected 1 argument, got #{arity}\" unless ( arity = arguments.length ) is 1\n    return 'null'       if x is null\n    return 'undefined'  if x is undefined\n    return 'infinity'   if ( x is Infinity  ) or  ( x is -Infinity  )\n    return 'boolean'    if ( x is true      ) or  ( x is false      )\n    return 'nan'        if ( Number.isNaN     x )\n    return 'float'      if ( Number.isFinite  x )\n    return 'buffer'     if ( Buffer.isBuffer  x )\n    return 'list'       if ( Array.isArray  x )\n    #.........................................................................................................\n    ### TAINT Not needed (?) b/c `@js_type_of x` does work with these values, too ###\n    ### this catches `Array Iterator`, `String Iterator`, `Map Iterator`, `Set Iterator`: ###\n    if ( tagname = x[ Symbol.toStringTag ] )? and ( typeof tagname ) is 'string'\n      return @_normalize_type tagname\n    #.........................................................................................................\n    ### Domenic Denicola Device, see https://stackoverflow.com/a/30560581 ###\n    return 'nullobject' if ( c = x.constructor ) is undefined\n    return 'object'     if ( typeof c ) isnt 'function'\n    if ( R = c.name.toLowerCase() ) is ''\n      return 'generator' if x.constructor is @_constructor_of_generators\n      ### NOTE: throw error since this should never happen ###\n      return ( ( Object::toString.call x ).slice 8, -1 ).toLowerCase() ### Mark Miller Device ###\n    #.........................................................................................................\n    return 'wrapper'  if ( typeof x is 'object' ) and R in [ 'boolean', 'number', 'string', ]\n    return 'regex'    if R is 'regexp'\n    return 'text'     if R is 'string'\n    ### thx to https://stackoverflow.com/a/29094209 ###\n    ### TAINT may produce an arbitrarily long throwaway string ###\n    return 'class'    if R is 'function' and x.toString().startsWith 'class '\n    return R\n\n############################################################################################################\n@defaults = GUY.lft.freeze @defaults\n\n#===========================================================================================================\nx = new @Intertype()\n# urge x.foo = 42\n# urge x.foo\n# urge x.has\n# urge x.has.foo\n# urge x.has.bar\n# try urge x.bar catch error then warn CND.reverse error.message\n\njs_type_of               = ( x ) => ( ( Object::toString.call x ).slice 8, -1 ).toLowerCase().replace /\\s+/g, ''\nlength_of = ( x ) ->\n  throw new Error \"^1^\" unless x?\n  return x.length if Object.hasOwnProperty x, length\n  return x.size   if Object.hasOwnProperty x, size\n  return ( Object.keys x ).length if ( js_type_of x ) is 'object'\n  throw new Error \"^2^\"\nnonempty  = ( x ) -> ( length_of x ) > 0\nempty     = ( x ) -> ( length_of x ) == 0\nlist_of   = ( type, x ) ->\n  return false unless ( js_type_of x ) is 'array'\n  return true if x.length is 0\n  # return x.every ( e ) -> isa type, e\n  return x.every ( e ) -> ( js_type_of e ) is type ### TAINT should use `isa` ###\n\n###\n\ntypes.isa.integer                                           42\ntypes.isa.even.integer                                      -42\ntypes.isa.odd.integer                                       41\ntypes.isa.negative1.integer                                 -42\ntypes.isa.negative0.integer                                 0\ntypes.isa.positive1.integer                                 42\ntypes.isa.positive0.integer                                 0\ntypes.isa.list_of.integer                                   [ 42, ]\ntypes.isa.nonempty.list_of.negative1.integer                [ -42, ]\ntypes.isa.nonempty.list_of.negative0.integer                [ 0, ]\ntypes.isa.nonempty.list_of.positive1.integer                [ 42, ]\ntypes.isa.nonempty.list_of.positive0.integer                [ 0, ]\ntypes.isa.empty.list_of.integer                             []\ntypes.isa.nonempty.list_of.integer                          [ 42, ]\ntypes.isa.optional.integer                                  42\ntypes.isa.optional.list_of.integer                          [ 42, ]\ntypes.isa.optional.empty.list_of.integer                    []\ntypes.isa.optional.nonempty.list_of.integer                 [ 42, ]\ntypes.isa.optional.negative1.integer                        -42\ntypes.isa.optional.negative0.integer                        0\ntypes.isa.optional.positive1.integer                        42\ntypes.isa.optional.positive0.integer                        0\ntypes.isa.optional.nonempty.list_of.negative1.integer       [ -42, ]\ntypes.isa.optional.nonempty.list_of.negative0.integer       [ 0, ]\ntypes.isa.optional.nonempty.list_of.positive1.integer       [ 42, ]\ntypes.isa.optional.nonempty.list_of.positive0.integer       [ 0, ]\ntypes.isa.optional.empty.list_of.negative1.integer          -42\ntypes.isa.optional.empty.list_of.negative0.integer          0\ntypes.isa.optional.empty.list_of.positive1.integer          42\ntypes.isa.optional.empty.list_of.positive0.integer          0\n\n[all]     [all]     [isa_collection]  [isa_collection]  [isa_numeric]   [isa_numeric]   [mandatory]\n————————————————————————————————————————————————————————————————————————————————————————————————————\nisa       optional  empty             list_of           even            negative0       <type>\nvalidate            nonempty                            odd             negative1\n                                                                        positive0\n                                                                        positive1\n###\n\n\n\n"
  ]
}